<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="gmair.machine.on_off">
    <resultMap id="on_offVo" type="finley.gmair.model.machine.Machine_on_off">
        <result property="configId" column="config_id"></result>
        <result property="machineId" column="uid"></result>
        <result property="status" column="status"></result>
        <result property="startTime" column="start_time"></result>
        <result property="endTime" column="end_time"></result>
        <result property="blockFlag" column="block_flag"></result>
        <result property="createAt" column="create_time"></result>
    </resultMap>
    
    <select id="query" parameterType="java.util.Map" resultMap="on_offVo">
        select config_id, uid, status, start_time, end_time, block_flag, create_time
        from gmair_machine.machine_on_off
        where 1 = 1
        <if test="configId != null">
            and config_id = #{configId}
        </if>
        <if test="machineId != null">
            and uid = #{machineId}
        </if>
        <if test="status != null">
            and status = #{status}
        </if>
        <if test="startTime != null">
            and start_time = #{startTime}
        </if>
        <if test="endTime != null">
            and end_time = #{endTime}
        </if>
        <if test="blockFlag != null">
            and block_flag = #{blockFlag}
        </if>
        order by create_time desc 
    </select>
    
    <insert id="insert" parameterType="finley.gmair.model.machine.Machine_on_off" useGeneratedKeys="false">
        insert into gmair_machine.machine_on_off(config_id, uid, status, start_time, end_time, block_flag, create_time)
        values(#{configId}, #{machineId}, #{status}, #{startTime}, #{endTime}, #{blockFlag}, #{createAt})
    </insert>

    <update id="update" parameterType="finley.gmair.model.machine.Machine_on_off">
        update gmair_machine.machine_on_off
        <set>
            <if test="status != null">
                status = #{status},
            </if>
            <if test="startTime != null">
                start_time = #{startTime},
            </if>
            <if test="endTime != null">
                end_time = #{endTime},
            </if>
            <if test="blockFlag != null">
                block_flag= #{blockFlag},
            </if>
            config_id = #{configId}
        </set>
        where config_id = #{configId}
    </update>
</mapper>