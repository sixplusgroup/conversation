<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="gmair.machinesetting">

    <resultMap id="PowerSettingVo" type="finley.gmair.vo.machine.PowerSettingVo">
        <result column="setting_id" property="settingId"/>
        <result column="consumer_id" property="consumerId"/>
        <result column="setting_name" property="settingName"/>
        <result column="code_value" property="codeValue"/>
        <result column="power_action" property="powerAction"
                typeHandler="finley.gmair.mybatis.handler.PowerActionTypeHandler"/>
        <result column="trigger_hour" property="triggerHour"/>
        <result column="trigger_minute" property="triggerMinute"/>
    </resultMap>

    <resultMap id="MachineSettingVo" type="finley.gmair.model.machine.v2.MachineSetting">
        <result column="setting_id" property="settingId"></result>
        <result column="consumer_id" property="consumerId"></result>
        <result column="setting_name" property="settingName"></result>
        <result column="code_value" property="codeValue"></result>
        <result column="block_flag" property="blockFlag"></result>
        <result column="create_time" property="createAt"></result>
    </resultMap>

    <select id="selectpowersetting" parameterType="java.util.Map" resultMap="PowerSettingVo">
        SELECT
        setting_id,
        consumer_id,
        setting_name,
        code_value,
        power_action,
        trigger_hour,
        trigger_minute
        FROM
        `gmair_machine`.`power_setting_view`
        WHERE
        1 = 1
        <if test="triggerHour != null">
            AND trigger_hour = #{triggerHour}
        </if>
        <if test="triggerMinute != null">
            AND trigger_minute = #{triggerMinute}
        </if>
        <if test="codeValue != null">
            AND code_value = #{codeValue}
        </if>
        <if test="settingName != null">
            AND setting_name = #{settingName}
        </if>
    </select>

    <select id="queryMachineSetting" parameterType="java.util.Map" resultMap="MachineSettingVo">
        SELECT setting_id, consumer_id, setting_name, code_value, block_flag, create_time
        FROM gmair_machine.machine_setting
        WHERE 1 = 1
        <if test="settingId != null">
            AND setting_id = #{settingId}
        </if>
        <if test="consumerId != null">
            AND consumer_id = #{consumerId}
        </if>
        <if test="settingName != null">
            AND setting_name = #{settingName}
        </if>
        <if test="codeValue != null">
            AND code_value = #{codeValue}
        </if>
        <if test="blockFlag != null">
            AND block_flag = #{blockFlag}
        </if>
    </select>

    <insert id="isnertMachineSetting" parameterType="finley.gmair.model.machine.v2.MachineSetting" useGeneratedKeys="false">
        INSERT INTO gmair_machine.machine_setting(setting_id, consumer_id, setting_name, code_value, block_flag, create_time)
        VALUES(#{settingId}, #{consumerId}, #{settingName}, #{codeValue}, #{blockFlag}, #{createAt})
    </insert>
</mapper>