<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="gmair.districtdivision.city">
    <resultMap id="cityVo" type="finley.gmair.vo.districtdivision.CityVo">
        <result property="cityId" column="city_id"></result>
        <result property="provinceId" column="province_id"></result>
        <result property="cityName" column="city_name"></result>
        <result property="cityPinyin" column="city_pinyin"></result>
        <result property="blockFlag" column="block_flag"></result>
        <result property="createAt" column="create_time"></result>
    </resultMap>

    <select id="query" parameterType="java.util.Map" resultMap="cityVo">
        SELECT city_id, province_id, city_name, city_pinyin, block_flag, create_time
        FROM gmair_location.city_list
        WHERE 1 = 1
        <if test="cityId != null">
            AND city_id = #{cityId}
        </if>
        <if test="provinceId != null">
            AND province_id = #{provinceId}
        </if>
        <if test="cityName != null">
            AND city_name = #{cityName}
        </if>
        <if test="cityPinyin != null">
            AND city_pinyin = #{cityPinyin}
        </if>
        <if test="blockFlag !=null">
            AND block_flag = #{blockFlag}
        </if>
        ORDER BY create_time DESC
    </select>

    <insert id="insertBatch" parameterType="java.util.List">
        INSERT INTO gmair_location.city_list
        (city_id, province_id, city_name, city_pinyin, block_flag, create_time)
        VALUES
        <foreach collection="list" item="item" index="index" separator=",">
          (
            #{item.cityId}, #{item.provinceId}, #{item.cityName}, #{item.cityPinyin},
            #{item.blockFlag}, #{item.createAt}
          )
        </foreach>
    </insert>

    <insert id="insert" parameterType="finley.gmair.model.district.City" useGeneratedKeys="false">
        INSERT INTO gmair_location.city_list
        (city_id, province_id, city_name, city_pinyin, block_flag, create_time)
        VALUES
        (#{cityId}, #{provinceId}, #{cityName}, #{cityPinyin}, #{blockFlag}, #{createAt})
    </insert>

    <update id="update" parameterType="finley.gmair.model.district.City">
        UPDATE gmair_location.city_list
        <set>
            <if test="provinceId != null">
                province_id = #{provinceId},
            </if>
            <if test="cityName != null">
                city_name = #{cityName},
            </if>
            <if test="cityPinyin != null">
                city_pinyin = #{cityPinyin},
            </if>
            <if test="blockFlag != null">
                block_flag = #{blockFlag},
            </if>
            city_id = #{cityId}
        </set>
        WHERE city_id = #{cityId}
    </update>
</mapper>